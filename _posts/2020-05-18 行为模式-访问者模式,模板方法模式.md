---
layout: post
title: "è¡Œä¸ºæ¨¡å¼"
date: 2020-05-14 16:34:41 +0800
categories: [è®¾è®¡æ¨¡å¼]
tags: è®¾è®¡æ¨¡å¼
comments: 1
toc: true
---

## è®¿é—®è€…æ¨¡å¼

### è®¿é—®è€…æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œ å®ƒèƒ½å°†ç®—æ³•ä¸å…¶æ‰€ä½œç”¨çš„å¯¹è±¡éš”ç¦»å¼€æ¥ã€‚

### è®¿é—®è€…æ¨¡å¼ç»“æ„ UML

![](https://user-gold-cdn.xitu.io/2020/5/15/17217440b13047df?w=520&h=540&f=png&s=53552)

### [è®¿é—®è€…å’ŒåŒåˆ†æ´¾](https://refactoringguru.cn/design-patterns/visitor-double-dispatch)

### ç¤ºä¾‹ä»£ç 

<p>Java ç¨‹åºåº“ä»£ç ä¸­è¯¥æ¨¡å¼çš„ä¸€äº›ç¤ºä¾‹<span class="chpule2">ï¼š</span><span class="chpuri2"> </span></p>
<ul>
<li>
<a href="https://docs.oracle.com/javase/8/docs/api/javax/lang/model/element/AnnotationValue.html"><span class="chpule1"> </span><code class="ml">javax.lang.model.element.AnnotationValue</code></a> å’Œ <a href="https://docs.oracle.com/javase/8/docs/api/javax/lang/model/element/AnnotationValueVisitor.html"><span class="chpule1"> </span><code class="ml">Annotation&shy;Value&shy;Visitor</code></a>
</li>
<li>
<a href="https://docs.oracle.com/javase/8/docs/api/javax/lang/model/element/Element.html"><span class="chpule1"> </span><code class="ml">javax.lang.model.element.Element</code></a> å’Œ <a href="https://docs.oracle.com/javase/8/docs/api/javax/lang/model/element/ElementVisitor.html"><span class="chpule1"> </span><code class="ml">Element&shy;Visitor</code></a>
</li>
<li>
<a href="https://docs.oracle.com/javase/8/docs/api/javax/lang/model/type/TypeMirror.html"><span class="chpule1"> </span><code class="ml">javax.lang.model.type.TypeMirror</code></a> å’Œ <a href="https://docs.oracle.com/javase/8/docs/api/javax/lang/model/type/TypeVisitor.html"><span class="chpule1"> </span><code class="ml">Type&shy;Visitor</code></a>
</li>
<li>
<a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/FileVisitor.html"><span class="chpule1"> </span><code class="ml">java.nio.file.FileVisitor</code></a> å’Œ <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/SimpleFileVisitor.html"><span class="chpule1"> </span><code class="ml">Simple&shy;File&shy;Visitor</code></a>
</li>
<li>
<a href="https://docs.oracle.com/javaee/7/api/javax/faces/component/visit/VisitContext.html"><span class="chpule1"> </span><code class="ml">javax.faces.component.visit.VisitContext</code></a> å’Œ <a href="https://docs.oracle.com/javaee/7/api/javax/faces/component/visit/VisitCallback.html"><span class="chpule1"> </span><code class="ml">Visit&shy;Callback</code></a>
</li>
</ul> 

> çœ‹ä¸‹ `ElementVisitor` çš„æºç :

```
public interface ElementVisitor<R, P> {
    //è®¿é—®å…ƒç´ 
    R visit(Element var1, P var2);
    default R visit(Element e) {
        return this.visit(e, (Object)null);
    }
    //è®¿é—®åŒ…å…ƒç´ 
    R visitPackage(PackageElement var1, P var2);
    //è®¿é—®ä¸€ä¸ªç±»å‹å…ƒç´ 
    R visitType(TypeElement var1, P var2);
    //è®¿é—®ä¸€ä¸ªå˜é‡ç±»å‹
    R visitVariable(VariableElement var1, P var2);
    //è®¿é—®ä¸€ä¸ªå¯æ‰§è¡Œçš„å…ƒç´ 
    R visitExecutable(ExecutableElement var1, P var2);
    //è®¿é—®ä¸€ä¸ªå‚æ•°å…ƒç´ 
    R visitTypeParameter(TypeParameterElement var1, P var2);
    //å¤„ç†æœªçŸ¥çš„å…ƒç´ ç±»å‹ , Java ä¸ºåç»­æ‰©å±•é¢„ç•™çš„æ¥å£
    //ä¾‹å¦‚åç»­å…ƒç´ ç±»å‹å¢åŠ äº†, é‚£ä¹ˆé€šè¿‡è¿™ä¸ªæ¥å£å°±å¯ä»¥å¤„ç†ä¸Šè¿°æ²¡æœ‰å£°æ˜çš„ç±»å‹
    R visitUnknown(Element var1, P var2);
    
    default R visitModule(ModuleElement e, P p) {
        return this.visitUnknown(e, p);
    }
}
```

> Android ç¨‹åºç¤ºä¾‹:

`APT` ä¸­çš„ `AbstractProcessor.process()` , è€Œä½¿ç”¨`APT`çš„æ¡†æ¶æœ‰`Butterknife`,`Retrofit`,`Dagger2`ç­‰ã€‚ 


## æ¨¡æ¿æ–¹æ³•æ¨¡å¼

### å½“ä½ åªå¸Œæœ›å®¢æˆ·ç«¯æ‰©å±•æŸä¸ªç‰¹å®šç®—æ³•æ­¥éª¤ï¼Œ è€Œä¸æ˜¯æ•´ä¸ªç®—æ³•æˆ–å…¶ç»“æ„æ—¶ï¼Œ å¯ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚

![](https://user-gold-cdn.xitu.io/2020/5/18/172254ea60d126c0?w=340&h=380&f=png&s=20730)

<p>Java ç¨‹åºåº“ä¸­æ¨¡ç‰ˆæ–¹æ³•çš„ç¤ºä¾‹<span class="chpule2">ï¼š</span><span class="chpuri2"> </span></p>
<ul>
<li>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html"><span class="chpule1"> </span><code class="ml">java.io.InputStream</code></a><span class="chpule2">ã€</span><span class="chpuri2"> </span><a href="https://docs.oracle.com/javase/8/docs/api/java/io/OutputStream.html"><span class="chpule1"> </span><code class="ml">java.io.OutputStream</code></a><span class="chpule2">ã€</span><span class="chpuri2"> </span><a href="https://docs.oracle.com/javase/8/docs/api/java/io/Reader.html"><span class="chpule1"> </span><code class="ml">java.io.Reader</code></a>  å’Œ <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Writer.html"><span class="chpule1"> </span><code class="ml">java.io.Writer</code></a> çš„æ‰€æœ‰éæŠ½è±¡æ–¹æ³•<span class="chpule2">ã€‚</span><span class="chpuri2"> </span></p>
</li>
<li>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/util/AbstractList.html"><span class="chpule1"> </span><code class="ml">java.util.AbstractList</code></a><span class="chpule2">ã€</span><span class="chpuri2"> </span><a href="https://docs.oracle.com/javase/8/docs/api/java/util/AbstractSet.html"><span class="chpule1"> </span><code class="ml">java.util.AbstractSet</code></a> å’Œ <a href="https://docs.oracle.com/javase/8/docs/api/java/util/AbstractMap.html"><span class="chpule1"> </span><code class="ml">java.util.AbstractMap</code></a> çš„æ‰€æœ‰éæŠ½è±¡æ–¹æ³•<span class="chpule2">ã€‚</span><span class="chpuri2"> </span></p>
</li>
<li>
<p><a href="https://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html"><span class="chpule1"> </span><code class="ml">javax.servlet.http.HttpServlet</code></a><span class="chpule2">ï¼Œ</span><span class="chpuri2"> </span>æ‰€æœ‰é»˜è®¤å‘é€ HTTP 405 <span class="chpule1"> </span><span class="chpuri1"><span class="noto noto-open">â€œ</span></span>æ–¹æ³•ä¸å…è®¸<span class="chpule2"><span class="noto">â€</span></span><span class="chpuri2"> </span>é”™è¯¯å“åº”çš„ <span class="chpule1"> </span><code class="ml">do&shy;XXX()</code> æ–¹æ³•<span class="chpule2">ã€‚</span><span class="chpuri2"> </span>ä½ å¯éšæ—¶å¯¹å…¶è¿›è¡Œé‡å†™<span class="chpule2">ã€‚</span><span class="chpuri2"> </span></p>
</li>
</ul>
<p><strong>è¯†åˆ«æ–¹å¼<span class="chpule2">ï¼š</span><span class="chpuri2"> </span></strong>æ¨¡ç‰ˆæ–¹æ³•å¯ä»¥é€šè¿‡è¡Œä¸ºæ–¹æ³•æ¥è¯†åˆ«<span class="chpule2">ï¼Œ</span><span class="chpuri2"> </span>è¯¥æ–¹æ³•å·²æœ‰ä¸€ä¸ªåœ¨åŸºç±»ä¸­å®šä¹‰çš„<span class="chpule1"> </span><span class="chpuri1"><span class="noto noto-open">â€œ</span></span>é»˜è®¤<span class="chpule2"><span class="noto">â€</span></span><span class="chpuri2"> </span>è¡Œä¸º<span class="chpule2">ã€‚</span><span class="chpuri2"> </span></p>


---
> å‚è€ƒ:
1. [Refactoring.Guru](https://refactoring.guru/)
2. ã€ŠAndroidæºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹
3. æ˜é‡‘ ğŸ‘‰ <https://juejin.im/post/5ebe33335188256d5952500c>  &  <https://juejin.im/post/5ec1dee45188256d877dc710>
